<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Post</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body>
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
            <div class="container px-4 px-lg-5">
                <a class="navbar-brand" href="index.html">J&A Blog</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="index.html">Home</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="about.html">About</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Page Header-->
        <header class="masthead" style="background-image: url('assets/img/post-bg-2.jpg')">
            <div class="container position-relative px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-md-10 col-lg-8 col-xl-7">
                        <div class="post-heading">
                            <h1>Windows 7: A not-so-deserted Operating System</h1>
                            <h2 class="subheading">End-of-Life = Vulnerability Gold Mine </h2>
                            <span class="meta">
                                Posted by
                                <a href="https:github.com/Josh-SCG">Joshua Esterhuizen</a>
                                on October 19, 2021
                            </span>
                            <span class="meta">
                                Read Time: ±10min
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Post Content-->
        <article class="mb-4">
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-md-10 col-lg-8 col-xl-7">
                        <h3>EOL for Win7</h3>
                        <blockquote class="blockquote"> <br>Support for Windows 7 ended on January 14, 2020. If you are still using Windows 7, your PC may become more vulnerable to security risks.</blockquote>
                        
                        <p> The above statement is taken from the <a href="https://www.microsoft.com/en-za/microsoft-365/windows/end-of-windows-7-support">Microsoft website</a>  and states the death of support for Windows 7. 
                            However, this has not stopped users from continuing to use this operating system since then. 
                            Steam lists in their <a href="https://store.steampowered.com/hwsurvey/Steam-Hardware-Software-Survey-Welcome-to-Steam?platform=combined">hardware and software survey</a> 
                            that as of August 2021 total of 8,91% of users are still running Windows 7. While this survey only has details 
                            for Steam users, this trend is also found with general PC users who either do not know how or 
                            simply do not want to update to a newer Windows version as well as businesses who do not want 
                            to waste time on the large scale transition to a new system. 
                        </p>
                        
                        <!--<div id="desktop-windows_version-ww-monthly-201912-202109" width="600" height="400" style="width:600px; height: 400px;"></div><p>Source: <a href="https://gs.statcounter.com/windows-version-market-share/desktop/worldwide/#monthly-201912-202109">StatCounter Global Stats - Windows Version Market Share</a></p><script type="text/javascript" src="https://www.statcounter.com/js/fusioncharts.js"></script><script type="text/javascript" src="https://gs.statcounter.com/chart.php?desktop-windows_version-ww-monthly-201912-202109&chartWidth=600"></script>-->
                        
                        <p>From the data and graph from <a href="https://gs.statcounter.com/">StatCounter</a> we can see that as of September 2021, roughly 16% of Windows users are still running Windows 7.</p>
                        
                        <h3>Exploits Waiting to Happen</h3>
                        <p> Even though Metasploit has an abundance of exploits for Windows XP and Vista, 
                            there are luckily, or unluckily depending on which end of the stick you find yourself, a few targeting Windows 7.
                        </p>

                        <p> One such exploit is the ms15_100_mcl_exe. While that naming convention may look 
                            daunting it simply stands for "Microsoft Windows Media Center 
                            MCL Vulnerability". The MCL bit here is a type of file used by Windows Media Center, 
                            similar to how .DOCX files are used in word,  
                            and stands for "Media Center Link." More information on this file type can be found 
                            <a href="https://fileinfo.com/extension/mcl">here.</a>
                        </p>

                        <p> Before we demonstrate how to use this exploit, there is one thing that must be stated. 
                            This is done purely for educational purposes - 
                            we at J&A Blog in no way condone any <i>black hat</i> hacking. 
                            Now, lets demonstrate this exploit.
                        </p>
                        
                        
                        <h2 class="section-heading">The ms15_100_mcl_exe Exploit on Metasploit</h2>
                        <p> At this point, if you are set on attempting this particular exploit, 
                            please go follow our guide on installing the 
                            necessary programs and requirements - which can be 
                            found on the homepage (or alternatively, right <a href="/blog/post3.html">here.</a>)
                            Also, this demonstration/tutorial is being done using Metasploit, via console, on a distribution of Kali Linux 
                            and against a Windows 7 Ultimate machine.
                        </p>
                        
                        <p> <b>Step 1: </b>Once you have Metasploit open in he console, use the search command to find the exploit as such: <br>
                            
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (1).PNG" alt="..." />                           
                        </p>

                        <p> <b>Step 2: </b>After hitting "Enter" you should see the results of this search displayed. If the search is empty, double check your spelling and try again. 
                            
                            <br><br><b>Step 3: </b>Once the results of the search are displayed, highlight the path in the console, right-click it and copy it to the clipboard.
                            
                            <br><br><b>Step 4: </b>Then type "use" into the command line and paste the selection again via right-clicking. Your screen should now look similar to this:
                            
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (2).PNG" alt="..." />
                            The command line should now reflect that you are using the ms15_100_mcl_exe exploit as shown in the image above by the red section in the last line.
                        </p>

                        <p> <b>Step 5: </b> By typing "info" into the command line, the information of this exploit is shown - items such as what the .exe and .mcl file are named as. 
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (3).PNG" alt="..." />
                            <br><br> As you can see, the files are currently only named msf.mcl and msf.exe. This is now where we must employ some form of deception.
                        </p>

                        <p> <b>Step 6: </b> Rename the files using the "set" command as shown in the image below where "x" is the name you can give the file. The "set" command works as follows:
                            <br> set "name_of_what_to_set" "what_to_change_to"
                            <br> Take note of the space between each word!
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (4).PNG" alt="..." />
                            For this demonstration, we will call these files "update" and the reason for this is because we want the target to open a .exe file and considering most people nowadays think twice about clicking on files labeled "worksheet.pdf.exe" it needs to look somewhat legitimate.
                        </p>

                        <p> <b>Step 7: </b> Set the payload and local host address. 
                            To set the payload we again use the "set" method followed by "PAYLOAD" 
                            and then the path to the payload we wish to use. The local host address is done in the same way using "set LHOST x".
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (5.1).PNG" alt="..." />
                            <br><br> To find the correct address to use, you must open a new terminal and type "ifconfig" and look for the address at "inet".
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (5.2).PNG" alt="..." />
                        </p>
                        <p> <b>Step 8: </b> Compile everything needed by typing "exploit" into the console.
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (6).PNG" alt="..." />
                            <br><br> This should result in the following screen.
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (7.1).PNG" alt="..." />
                            <br><br> To double check that everything is ready, in a <b>new</b> terminal, move into the highlighted directory in the previous image
                            through the use of the "cd" command. Take note of where the directory ends - we want to view the contents of the folder where the file is.
                            Then use the command "ls" to list the contents in the folder and look if the .mcl file is present. Since ours is named update, we can see it has been created.
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (7.2).PNG" alt="..." />
                        </p>

                        <p> <b>Step 9: </b> Have the target install the .exe file. 
                            <br><br>This is the tricky part in real-life for attackers. We've somewhat made it easier to accomplish
                            by naming the file something that seems inconspicuous, however, we still need a person to install it and this is the point in real life 
                            that some form of <i>Social Engineering</i> may be used. Social engineering is defined below:
                            <blockquote class="blockquote"> In the context of information security, social engineering is the psychological manipulation of people into performing actions or divulging confidential information. </blockquote>
                            Hopefully, it just became clear why we called our file update.exe! If not, one scenario where this .exe could be used is if we contact a person via a phone call or email claiming to be some software company - 
                            this is a typical method where attackers would pose as a Microsoft employee and get a person to install 
                            some needed update for some reason. Even the method for getting this .exe to a person is done remotely 
                            and may seem legitimate at first.
                            
                            <br><br> On the same screen as before, look for the "Malicious executable at ..." section. It has been highlighted in the following image to help.
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (8).PNG" alt="..." />
                            <br><br>This is the address where our update.exe can be downloaded and installed from.
                            (PS - <b>DO NOT</b> install this on your personal computer. It's called malicious for a reason!)
                            
                            <br><br> This is the point where we now open the Windows machine 
                            (Please again refer to the <a href="/blog/post3.html">DIY Guide.</a> if stuck).
                            Hitting the Windows key and R (⊞ + R) will open the Run dialogue box where that address should now be entered as shown below.
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (9).PNG" alt="..." />

                            <br><br> After clicking "OK" or hitting "enter", the following, or similar box, should pop-up if the target has their firewall enabled.
                            <img class="img-fluid" src="assets/post2pics/post2walkthrough (10).PNG" alt="..." />
                            <br><br>If the firewall is disabled, a different pop-up appears that instead if location, asks if you trust a file without any certificates.
                            This box is almost too familiar to student and hobbyist programmers alike as neither have access to these certificates and most applications cause this pop-up
                            and as such is typically ignored anyway.
                        </p>
                        
                        <span class="caption text-muted">Arguing that you don't care about the right to privacy because you have nothing to hide is no different than saying you don't care about free speech because you have nothing to say.</span>
                    </div>
                </div>
            </div>
        </article>
        <!-- Footer-->
        <footer class="border-top">
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-md-10 col-lg-8 col-xl-7">
                        <ul class="list-inline text-center">
                            <li class="list-inline-item">
                                <a href="https://github.com/Josh-SCG">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            
                            <li class="list-inline-item">
                                <a href="https://github.com/AM-ops">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                        </ul>
                        <div class="small text-center text-muted fst-italic">&bull; Copyright &copy; ITRI625 Project 2021 &bull;</div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
